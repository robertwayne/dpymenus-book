<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Discord Menus</title>
        
        <meta name="robots" content="noindex" />
        
        


        <!-- Custom HTML head -->
        


        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        
        <link rel="icon" href="favicon.svg">
        
        
        <link rel="shortcut icon" href="favicon.png">
        
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        
        <link rel="stylesheet" href="css/print.css" media="print">
        

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        
        <link rel="stylesheet" href="fonts/fonts.css">
        

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "ayu" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="intro.html">Introduction</a></li><li class="chapter-item expanded affix "><li class="part-title">Getting Started</li><li class="chapter-item expanded "><a href="installation.html"><strong aria-hidden="true">1.</strong> Installation</a></li><li class="chapter-item expanded "><a href="running_examples.html"><strong aria-hidden="true">2.</strong> Running Examples</a></li><li class="chapter-item expanded affix "><li class="part-title">Building Menus</li><li class="chapter-item expanded "><a href="text_menus.html"><strong aria-hidden="true">3.</strong> Text-Based Menus</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">4.</strong> Button-Based Menus</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">4.1.</strong> Using a PaginatedMenu</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">4.1.1.</strong> Overriding Default Buttons</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">4.2.</strong> Using a Poll</div></li></ol></li><li class="chapter-item expanded "><a href="local_configuration.html"><strong aria-hidden="true">5.</strong> Configuring Your Menu</a></li><li class="chapter-item expanded "><a href="templates.html"><strong aria-hidden="true">6.</strong> Templates</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="field_overrides.html"><strong aria-hidden="true">6.1.</strong> Field Overrides</a></li></ol></li><li class="chapter-item expanded "><a href="pages.html"><strong aria-hidden="true">7.</strong> Creating Pages</a></li><li class="chapter-item expanded affix "><li class="part-title">Configuration</li><li class="chapter-item expanded "><a href="global_configuration.html"><strong aria-hidden="true">8.</strong> Using pyproject.toml</a></li><li class="chapter-item expanded "><a href="constants.html"><strong aria-hidden="true">9.</strong> Constant Variables</a></li><li class="chapter-item expanded affix "><li class="part-title">Advanced Features</li><li class="chapter-item expanded "><a href="dynamic_data.html"><strong aria-hidden="true">10.</strong> Passing Dynamic Data</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">11.</strong> Sessions</div></li><li class="chapter-item expanded "><a href="lifecycle.html"><strong aria-hidden="true">12.</strong> Lifecycle</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="hooks.html"><strong aria-hidden="true">12.1.</strong> Hooks</a></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><a href="contributing.html">Contributing</a></li><li class="chapter-item expanded affix "><a href="projects.html">Other Projects</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        
                    </div>

                    <h1 class="menu-title">Discord Menus</h1>

                    <div class="right-buttons">
                        
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        
                        
                        <a href="https://github.com/robertwayne/dpymenus" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        
                        

                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="introduction"><a class="header" href="#introduction">Introduction</a></h1>
<p><code>dpymenus</code> is an unofficial extension for the <code>discord.py</code> library that aims to help developers build dynamic menus for
their bots easily.</p>
<h2 id="features"><a class="header" href="#features">Features</a></h2>
<ul>
<li>Handles text &amp; button inputs</li>
<li>Easy-to-build menus with paginated data, multiple choices, and polls</li>
<li>Template system for quickly defining a cohesive style for your menus</li>
<li>User-defined callbacks &amp; event hooks for complex use-cases</li>
<li>Awesome examples and documentation to get rolling quickly</li>
</ul>
<p>This book will provide complete coverage of the libraries functions, how to use them, and exists alongside a full set of
runnable examples, so you can see every feature!</p>
<h2 id="links"><a class="header" href="#links">Links</a></h2>
<p><strong><a href="https://dpymenus.readthedocs.io/en/latest/">API Documentation</a></strong></p>
<p><strong><a href="https://github.com/robertwayne/dpymenus">GitHub Repository</a></strong></p>
<p><strong><a href="https://pypi.org/project/dpymenus/">PyPi</a></strong></p>
<div id="chapter_begin" style="break-before: page; page-break-before: always;"></div><h1 id="installation"><a class="header" href="#installation">Installation</a></h1>
<p>Installing <code>dpymenus</code> is very simple. First, ensure you are running Python 3.8 or higher.</p>
<blockquote>
<p><strong>Version Support</strong></p>
<p>As of v2, support for 3.7 was dropped due to various internal preferences.
I try to work with modern versions of the language, so supporting versions far behind
would be a hindrance to myself and my enjoyment of programming.</p>
</blockquote>
<p>Second, make sure you are in your virtual environment <em>(if you are not using Poetry)</em>. This trips up many newcomers to
the language, but it's a critical step.</p>
<p>Last, run this in your command-line:</p>
<pre><code class="language-shell">pip install dpymenus
</code></pre>
<p>If you use Poetry:</p>
<pre><code class="language-shell">poetry add dpymenus
</code></pre>
<h2 id="development-branch"><a class="header" href="#development-branch">Development Branch</a></h2>
<p>If you are interested in using the development branch, you can run:</p>
<pre><code class="language-shell">pip install git+https://github.com/robertwayne/dpymenus.git@next
</code></pre>
<pre><code class="language-shell">poetry add git+https://github.com/robertwayne/dpymenus.git#next
</code></pre>
<p>Please note that there are no stability or documentation guarantees for this branch. It is <strong>NOT</strong> recommended using the
development branch unless you know what you are doing.</p>
<div id="chapter_begin" style="break-before: page; page-break-before: always;"></div><h1 id="running-examples"><a class="header" href="#running-examples">Running Examples</a></h1>
<p><code>dpymenus</code> contains a working example for almost every feature most developers will be using. All the examples run as separate cogs on a bot that you can load up yourself.</p>
<p>All of these instructions should work on Linux (Ubuntu-flavors) &amp; Windows 10.</p>
<p>In your command line <em>(PowerShell if you are on Windows)</em>:</p>
<ol>
<li>
<p>Clone the repository.</p>
<pre><code class="language-shell">git clone https:github.com/robertwayne/dpymenus
</code></pre>
</li>
<li>
<p>Move into the directory you just cloned.</p>
<pre><code class="language-shell">cd dpymenus
</code></pre>
</li>
<li>
<p>We need to create a <code>.env</code> file and add a token to it.</p>
<pre><code class="language-shell">echo &quot;BOT_TOKEN=your_private_token_here&quot; &gt; .env
</code></pre>
<p>Replace the <code>your_private_token_here</code> text with the token from your
<strong><a href="https://discord.com/developers/applications">Discord Developers</a></strong>
bot page. If you are unsure what to use, please see the
<strong><a href="https://discordpy.readthedocs.io/en/stable/discord.html">discord.py guide</a></strong>.</p>
</li>
<li>
<p>Install Poetry and the project dependencies.</p>
<pre><code class="language-shell">pip -m install poetry &amp;&amp; poetry install
</code></pre>
<blockquote>
<p>Please note that this is not the preferred way to install Poetry. Instead,
you should follow the <strong><a href="https://python-poetry.org/docs/#installation">guide</a></strong> on their site.
I highly recommend Poetry as a package manager for Python, so it is not wasted
effort to download and learn properly.</p>
</blockquote>
</li>
<li>
<p>Run the bot!</p>
<pre><code class="language-shell">poetry run examples
</code></pre>
</li>
</ol>
<p>At this point, the bot should be up and running. All the cogs are loaded automatically thanks to <strong><a href="&#x27;https://github.com/robertwayne/cogwatch">cogwatch</a></strong>, so you can add the bot to your server and start using commands. The next page will list all the available commands and what they do.</p>
<div id="chapter_begin" style="break-before: page; page-break-before: always;"></div><h1 id="text-based-menus"><a class="header" href="#text-based-menus">Text-Based Menus</a></h1>
<p>Text-based menus are useful when you need a way to parse user text, or just as a means to limit your requests against
the Discord API <em>(button-based menus have inherent overhead because of this)</em>.</p>
<p>Let's look at the official <code>text_menu_example.py</code>.</p>
<h2 id="imports"><a class="header" href="#imports">Imports</a></h2>
<pre><code class="language-python">from dpymenus import Page, TextMenu
from dpymenus.constants import CONFIRM
</code></pre>
<p>We always want to import the <code>Page</code> class, as it is an enhanced form of the <code>Embed</code>. In addition, we will import the
type of menu we are creating. We will also make use of some constants provided by the library to make validating input
easier. You'll read more on that later.</p>
<h2 id="cog-core"><a class="header" href="#cog-core">Cog Core</a></h2>
<pre><code class="language-python">class MyTextMenu(commands.Cog):
    def __init__(self, client):
        self.client = client


def setup(client):
    client.add_cog(MyTextMenu(client))
</code></pre>
<p>The 'core' of a cog, or a <code>discord.py</code> command file, generally looks like this. We inherit from the <code>commands.Cog</code>
class, and we always supply a <code>setup</code> function, which adds the cog to your bot instance. Inside the core, we will be
able to add our command and relevant menu code.</p>
<h2 id="command"><a class="header" href="#command">Command</a></h2>
<pre><code class="language-python">@commands.command()
async def text(self, ctx):
    page1 = Page(title='Ping Menu', description='Are you absolutely sure you want to send a ping command?', )
    page1.set_footer(text='Type `yes` if you are sure.\nType `quit` to cancel this menu.')
    page1.on_next(self.confirm)

    page2 = Page(title='Ping Menu', description='Pong!')

    menu = TextMenu(ctx)
    menu.add_pages([page1, page2])
    menu.normalize_responses()
    await menu.open()
</code></pre>
<p>The first lines, the decorator and definition, define our command. Next, we set up several pages. A Page inherits from
Embed, so you have access to all the regular methods and attributes on Embeds here. We do have additional methods
though, which you would notice as <code>on_next</code> in this example.</p>
<p><code>on_next</code> is a method which takes a callable <em>(function or method)</em> reference and sets it up internally as a page
callback. We will look at the specific callback, <code>self.confirm</code>, in a moment.</p>
<p>You'll notice <code>page2</code> does not have an <code>on_next</code>. This signifies the end of a menu, or the last page.</p>
<h2 id="menu-breakdown"><a class="header" href="#menu-breakdown">Menu Breakdown</a></h2>
<pre><code class="language-python">menu = TextMenu(ctx)
</code></pre>
<p>This is how a menu is initialized. It always takes your command context as an argument, and optionally can take a
template. You will read about templates in a later chapter.</p>
<hr />
<pre><code class="language-python">menu.add_pages([page1, page2])
</code></pre>
<p>This is how pages are added to a menu instance. It takes a list of Page or Embed objects. In this case, we assigned our
pages to variables <em>(page1 and page2)</em> and put those variables in the list argument.</p>
<hr />
<pre><code class="language-python">menu.normalize_responses()
</code></pre>
<p>This is a special method for text-based menus that will normalize user input. It strips unnessecary whitespace and
converts it to lowercase. This makes it easier to process the input for you.</p>
<hr />
<pre><code class="language-python">await menu.open()
</code></pre>
<p>This method should be the final thing you call on your menu. It will start the menu up, which means running through the
pre-validation steps, creating a user-menu session, and starting the main menu loop. At this point, your menu will be
intractable in Discord.</p>
<h2 id="callback-breakdown"><a class="header" href="#callback-breakdown">Callback Breakdown</a></h2>
<pre><code class="language-python">@staticmethod
async def confirm(menu):
    if menu.response_in(CONFIRM):
        await menu.next()
</code></pre>
<p>This is a normal static method. Note that a menu callback must <strong>always</strong> be async. It takes a menu instance as the
argument, so you can access various menu methods and data.</p>
<p>In this example, we will use a special method on the text-based menu class called <code>response_in</code>, which checks if the
user input is in the supplied list of data. <code>CONFIRM</code> is a list containing values like 'y' and 'yes', so if the user
types a 'y' in chat, this will return true and proceed to the next line.</p>
<p><code>next</code> is a method available on all menu types which simply proceeds to the next available page.</p>
<p>When the menu updates, it will always check if the current page has a callback. Because our second page did not define
one, an internal method will run that closes our menu and ends the user-menu session.</p>
<div id="chapter_begin" style="break-before: page; page-break-before: always;"></div><h1 id="configuring-your-menu"><a class="header" href="#configuring-your-menu">Configuring Your Menu</a></h1>
<p>Menus instances can be configured with various methods that exist on each type.
All of these methods return themselves, so they can be chained.</p>
<p>See the <strong><a href="https://dpymenus.readthedocs.io/en/latest/">API Docs</a></strong> for all of the methods available on each menu.</p>
<div id="chapter_begin" style="break-before: page; page-break-before: always;"></div><h1 id="templates"><a class="header" href="#templates">Templates</a></h1>
<p>Templates are objects you can apply to a menu which applies a style or attribute across all pages. Some examples include color, footers, and fields.</p>
<h2 id="usage"><a class="header" href="#usage">Usage</a></h2>
<pre><code class="language-python">from dpymenus import PaginatedMenu, Template

template = Template(...)
menu = PaginatedMenu(ctx)
menu.add_pages([...], template=template)
</code></pre>
<p>We want to import the <code>Template</code> class, which is exposed in the base dpymenus namescape. We can then build create a new Template instance as we would with any class.</p>
<p>The template takes a variety of keyword arguments:</p>
<ul>
<li>
<p>title: <em>string</em></p>
</li>
<li>
<p>description: <em>string</em></p>
</li>
<li>
<p>color: <em>string</em></p>
</li>
<li>
<p>footer: <em>dictionary</em> -&gt; { text: <em>string</em>, icon_url: <em>string</em> }</p>
</li>
<li>
<p>image: <em>string</em></p>
</li>
<li>
<p>url: <em>string</em></p>
</li>
<li>
<p>thumbnail: <em>string</em></p>
</li>
<li>
<p>author: <em>dictionary</em> -&gt; { name: string, url: string, icon_url: string }</p>
</li>
<li>
<p>fields: <em>list</em> -&gt; <em>dictionary</em> -&gt; { name: <em>string</em>, value: <em>string</em>, inline: <em>boolean</em> }</p>
</li>
<li>
<p><em>field_style</em>*</p>
</li>
<li>
<p><em>field_sort</em>*</p>
<p>*<em>see the <strong><a href="./field_overrides.html">next page</a></strong> for details</em></p>
</li>
</ul>
<p>Most of these are self-explanatory, as they mirror the same attributes on an Embed or Page. An important distinction is what values they take -- typically favoring a single string representing the data.</p>
<h2 id="footer-author--fields"><a class="header" href="#footer-author--fields">Footer, Author, &amp; Fields</a></h2>
<p>The Footer and Author arguments take a dictionary containing the same keys one would normally use when adding these to an Embed or Page.</p>
<p>Fields are a bit different, as you generally create them by calling a separate <code>.add_field()</code> function every time. In this case, you pass a list as the argument containing a dictionary for each field. The dictionary, again, contains the same values used when creating them on a standard Embed or Page.</p>
<div id="chapter_begin" style="break-before: page; page-break-before: always;"></div><h1 id="field-overrides"><a class="header" href="#field-overrides">Field Overrides</a></h1>
<p>When adding fields in with a template, you might want to control how they are displayed in relation to existing fields on your Embeds or Pages. In this case, we can use field overrides.</p>
<h2 id="usage-1"><a class="header" href="#usage-1">Usage</a></h2>
<pre><code class="language-python">from dpymenus import Template, FieldStyle, FieldSort

template = Template(..., 
        field_style=FieldStyle.COMBINE, 
        field_sort=FieldSort.LAST
    )
</code></pre>
<p>Both of the override options are enumerated values.</p>
<h2 id="field-styles"><a class="header" href="#field-styles">Field Styles</a></h2>
<p><strong>IGNORE</strong>: templated fields will NOT be added if there is an existing field <em>(default)</em></p>
<p><strong>COMBINE</strong>: templated fields will be added if there is an existing field or not</p>
<p><strong>OVERRIDE</strong>: templated fields will overwrite existing fields</p>
<h2 id="field-sorts"><a class="header" href="#field-sorts">Field Sorts</a></h2>
<p>Sorting only takes effect when using the <code>FieldStyle.COMBINE</code> on your template, as this determines how the fields will actually be combined.</p>
<p><strong>FIRST</strong>: templated fields will be displayed before existing fields</p>
<p><strong>LAST</strong>:  templated fields will be displayed after existing fields <em>(default)</em></p>
<div id="chapter_begin" style="break-before: page; page-break-before: always;"></div><h1 id="creating-pages"><a class="header" href="#creating-pages">Creating Pages</a></h1>
<p>Pages are integral to creating menus. A page is really just an Embed with extra properties, such as various callback functionality. Any valid Embed is a valid Page, but not the other way around.</p>
<h2 id="callbacks"><a class="header" href="#callbacks">Callbacks</a></h2>
<p>When you are using pages in menus other than a PaginatedMenu, you must define callbacks on each page so the menu knows how to generate and what to do when user input is processed. EVERY page other than your last, has to include an <code>on_next()</code> callback. The others are optional.</p>
<p>A callback in our case is a reference to a function that you define, which is passed into the <code>.on_next()</code> method. It is important that you only pass a reference in, which means exclude the parenthesis.</p>
<p>If you added the parenthesis, it would call the function immediately instead of deferring it for later when the menu executes its next functions.</p>
<p>See the <strong><a href="https://dpymenus.readthedocs.io/en/latest/">API Docs</a></strong> for specific callback functions available on each page.</p>
<h2 id="sending-page-instances"><a class="header" href="#sending-page-instances">Sending Page Instances</a></h2>
<p>If you are using pages in complex or non-standard ways, you should always call the <code>.as_safe_embed()</code> method on the instance before sending it via a Discord message.</p>
<div id="chapter_begin" style="break-before: page; page-break-before: always;"></div><h1 id="using-pyprojecttoml-to-configure-menus"><a class="header" href="#using-pyprojecttoml-to-configure-menus">Using pyproject.toml to Configure Menus</a></h1>
<p>General global settings within the library can be configured with a <code>pyproject.toml</code> file in your root directory.</p>
<p>Everything should be listed under a <code>[dpymenus]</code> header.</p>
<h2 id="general"><a class="header" href="#general">General</a></h2>
<table><thead><tr><th>Variable</th><th>Type</th><th>Default</th><th>Description</th></tr></thead><tbody>
<tr><td>history-cache-limit</td><td>int</td><td>10</td><td>Limit on the history cache. 0 disables.</td></tr>
<tr><td>hide-warnings</td><td>bool</td><td>False</td><td>Shows/hides library warnings in the console.</td></tr>
<tr><td>reply-as-default</td><td>bool</td><td>False</td><td>Enables/disables the Discord reply feature.</td></tr>
<tr><td>button-delay</td><td>float</td><td>0.35</td><td>Delay, in milliseconds, between adding buttons to a page.</td></tr>
<tr><td>timeout</td><td>int</td><td>120</td><td>Duration, in seconds, before a menu is timed out and closed.</td></tr>
</tbody></table>
<h2 id="sessions"><a class="header" href="#sessions">Sessions</a></h2>
<table><thead><tr><th>Variable</th><th>Type</th><th>Default</th><th>Description</th></tr></thead><tbody>
<tr><td>allow-session-restore</td><td>bool</td><td>False</td><td>Enables/disabled the session restore feature.</td></tr>
<tr><td>sessions-per-channel</td><td>int</td><td>1</td><td>Limits sessions per channel.</td></tr>
<tr><td>sessions-per-guild</td><td>int</td><td>3</td><td>Limits sessions per guild.</td></tr>
<tr><td>sessions-per-user</td><td>int</td><td>10</td><td>Limits sessions per user.</td></tr>
<tr><td>session-timeout</td><td>int</td><td>3600</td><td>Duration, in seconds, before sessions are removed from the store.</td></tr>
</tbody></table>
<h2 id="constants"><a class="header" href="#constants">Constants</a></h2>
<table><thead><tr><th>Variable</th><th>Type</th><th>Default</th></tr></thead><tbody>
<tr><td>constants-confirm</td><td>List[str]</td><td>['y', 'yes', 'ok', 'k', 'kk', 'ready', 'rdy', 'r', 'confirm', 'okay']</td></tr>
<tr><td>constants-deny</td><td>List[str]</td><td>['n', 'no', 'deny', 'negative', 'back', 'return']</td></tr>
<tr><td>constants-quit'</td><td>List[str]</td><td>['e', 'exit', 'q', 'quit', 'stop', 'x', 'cancel', 'c']</td></tr>
<tr><td>constants-buttons</td><td>List[str]</td><td>['‚èÆÔ∏è', '‚óÄÔ∏è', '‚èπÔ∏è', '‚ñ∂Ô∏è', '‚è≠Ô∏è']</td></tr>
</tbody></table>
<p>*See the **<a href="./constants.html">next page</a> *<em>for detailed information on constants.</em></p>
<h2 id="example-file"><a class="header" href="#example-file">Example File</a></h2>
<pre><code class="language-toml">[dpymenus]
history-cache-limit = 10
sessions-per-channel = 1
sessions-per-guild = 3
sessions-per-user = 10
session-timeout = 3600
allow-session-restore = false
hide-warnings = false
reply-as-default = false
button-delay = 0.35
timeout = 15
constants-confirm = ['yes', 'y']
constants-deny = ['no', 'n']
constants-quit = ['quit', 'q']
constants-buttons = ['‚èÆÔ∏è', '‚¨ÖÔ∏èÔ∏è', 'üõë', '‚û°Ô∏èÔ∏è', '‚è≠Ô∏è'] 
</code></pre>
<div id="chapter_begin" style="break-before: page; page-break-before: always;"></div><h1 id="constant-variables"><a class="header" href="#constant-variables">Constant Variables</a></h1>
<p>The library comes with several pre-defined variables in the constants import to make working with menus a bit more seamless. While I try to provide sane defaults,
each of the options can be overriden.</p>
<p>As you saw on the <a href="./global_configuration.html">previous page</a>, they are simply lists of strings.</p>
<h2 id="text-constants"><a class="header" href="#text-constants">Text Constants</a></h2>
<pre><code class="language-python">from dpymenus.constants import CONFIRM, DENY, QUIT
</code></pre>
<p>When creating text-based menus that require users to enter responses, you'll often
need to check for values such as 'yes', 'no', and 'quit'. By default, text-based menus all use the QUIT constants internally to allow users to close out of menus.</p>
<h2 id="button-constants"><a class="header" href="#button-constants">Button Constants</a></h2>
<pre><code class="language-python">from dpymenus.constants import GENERIC_BUTTONS
</code></pre>
<p>In general, you shouldn't have to import these directly and they should be overriden using the <code>pyproject.toml</code> file. This is used internally for the
PaginatedMenu to display its reaction buttons.</p>
<p>When overriding this value, make sure you place your buttons in the order they
will be displayed on the PaginatedMenu:</p>
<pre><code>first_page, back, close, next, last_page
</code></pre>
<p>Also, note that PagiantedMenu provides a general method for managing this: <code>add_buttons([...])</code>. You should prefer to use this method unless you have multiple menus which should have their default buttons overridden.</p>
<div id="chapter_begin" style="break-before: page; page-break-before: always;"></div><h1 id="passing-dynamic-data-between-pages"><a class="header" href="#passing-dynamic-data-between-pages">Passing Dynamic Data Between Pages</a></h1>
<p>Oftentimes you will need to pass data around a menu that could change. For example, let's say you had a menu allowing a user to answer several questions and then confirm them all on the last page. You <em>can</em> just add all of the values onto your menu instance itself if they are static, but if they are dynamic, that often means using <code>setattr()</code> and <code>getattr()</code>, validation checks, etc.</p>
<p>In addition, if the cog loading in your command has various menus which can be instantiated within it, you may be polluting the class with lots of attributes.</p>
<p>There's not neccesarily a right or wrong way to handle this, but the library provides a minor abstraction over this for ease of use. Benefits include not accessing data which your menu shouldn't have access to and simplicity of working with just a dictionary.</p>
<p>To use this abstraction, just call the <code>.set_data()</code> method on a menu instance and pass in a dictionary containing the values you will be using.</p>
<p>From there, you can access that instances data with <code>menu.data.get(val, [default])</code> as you would with any other dictionary. Scoped and clean!</p>
<div id="chapter_begin" style="break-before: page; page-break-before: always;"></div><h1 id="lifecycle"><a class="header" href="#lifecycle">Lifecycle</a></h1>
<p>Menus consist of three basic stages: open, update, and close. Most of the time is spent in the update stage, which processes user input, handles transitions, and manages any state data. In general, you don't really need to know anything about menu state management unless you are using hooks <em>(in the next chapter)</em> or overriding the <code>BaseMenu</code> class.</p>
<p>This page can be used as a reference for the menu lifecycle.</p>
<h2 id="open"><a class="header" href="#open">Open</a></h2>
<p>When a menu is opened, it will always execute these steps first:</p>
<ol>
<li>Attempt to create or acquire (if enabled) a user session</li>
<li>Initialize the history and starting page</li>
<li>Execute any open hooks</li>
<li>Send the initial message (and initializes the <code>output</code> attribute)</li>
<li>Sets the <code>input</code> attribute</li>
<li>Updates the history</li>
<li>Deletes the input message</li>
<li>(Optional) Executes specific menu methods</li>
<li>Executes any post-open hooks</li>
<li>Executes any pre-update hooks</li>
</ol>
<h2 id="update"><a class="header" href="#update">Update</a></h2>
<p>An update cycle is performed on every iteration of a menu, whether a page change is executed or not. The steps vary per
menu, but generally look as follows:</p>
<ol>
<li>Wait for user input</li>
<li>Assign input to a variable</li>
<li>Execute methods based on input checks</li>
<li>Execute any post-update hooks</li>
<li>Execute transition method (whether it's next, close, or wait)</li>
</ol>
<h2 id="close"><a class="header" href="#close">Close</a></h2>
<p>When a menu is closed, it goes through the following steps:</p>
<ol>
<li>Execute any pre-close hooks</li>
<li>Closes out user session</li>
<li>Deletes the Discord message</li>
<li>Executes any post-close hooks</li>
</ol>
<div id="chapter_begin" style="break-before: page; page-break-before: always;"></div><h1 id="event-hooks"><a class="header" href="#event-hooks">Event Hooks</a></h1>
<p>The library offers extensive hook capabilities for all stages of a menus' lifecycle. Let's look at the official
<code>menu_hooks_example.py</code>. In particular, we will zoom in on the method adding our hooks.</p>
<pre><code class="language-python">from dpymenus import hooks

...
menu.add_hook(hooks.BEFORE, hooks.UPDATE, self.counter)
menu.add_hook(hooks.AFTER, hooks.CLOSE, self.show_total)
...
</code></pre>
<p>First, we want to import hooks from the library, so we can access the HookEvent and HookWhen enums.</p>
<p><code>add_hook</code> is available on every menu type, and takes 3 arguments: when to call the hook, on which event, and a callback function.</p>
<h2 id="hook-enums"><a class="header" href="#hook-enums">Hook Enums</a></h2>
<h3 id="hookwhen"><a class="header" href="#hookwhen">HookWhen</a></h3>
<table><thead><tr><th>HookWhen</th><th>Description</th></tr></thead><tbody>
<tr><td>BEFORE</td><td>Executes before the specified event runs.</td></tr>
<tr><td>AFTER</td><td>Executes after the specified event runs.</td></tr>
</tbody></table>
<p>The HookWhen enums are self-explanatory, they just define whether to run your hook before or after the specified event.</p>
<h3 id="hookevent"><a class="header" href="#hookevent">HookEvent</a></h3>
<table><thead><tr><th>HookEvent</th><th>Description</th></tr></thead><tbody>
<tr><td>OPEN</td><td>Attaches to the open stage.</td></tr>
<tr><td>UPDATE</td><td>Attaches to the open stage.</td></tr>
<tr><td>CLOSE</td><td>Attaches to the open stage.</td></tr>
<tr><td>TIMEOUT</td><td>Attaches to a timeout event.</td></tr>
</tbody></table>
<p>For most of the events, you can see where the hook would be executed on the previous chapter on lifecycles. Each event is explicitly listed where its hook will be executed in the call stack. Timeouts are a special case, however.
This event is called when with a user-defined timeout expires, resulting in the menu closing out.</p>
<p><em>There are currently no hooks for user cancels, failures, and session state changes.</em></p>
<div id="chapter_begin" style="break-before: page; page-break-before: always;"></div><h1 id="contributing"><a class="header" href="#contributing">Contributing</a></h1>
<p>I am open to all contributions, so long as it fits within the scope of the library. Large or breaking changes should be
discussed via issue before submitting a PR, but smaller changes can be submitted directly for review.</p>
<h2 id="scope"><a class="header" href="#scope">Scope</a></h2>
<p>The overall scope for the project is as follows:</p>
<ul>
<li>Implement a simple-to-use API for creating menus with discord.py</li>
<li>Support various styles of commonly-used menus out of the box</li>
<li>Supply easy-to-override abstractions and settings across menus</li>
<li>Supply generally useful default settings &amp; constants</li>
<li>Offer full documentation on all features via the book, examples, and docstrings.</li>
</ul>
<h2 id="building"><a class="header" href="#building">Building</a></h2>
<p>This library is built against a minimum version of Python 3.8.</p>
<p><code>dpymenus</code> uses the <strong><a href="https://python-poetry.org/">Poetry</a></strong> package manager to manage dependencies and builds. Make sure
you have Poetry installed via the <strong><a href="https://python-poetry.org/docs/#installation">official installation instructions</a></strong>.</p>
<ol>
<li>
<p>Clone the repository and checkout the <code>next</code> branch:</p>
<pre><code class="language-shell">git clone https://github.com/robertwayne/dpymenus
</code></pre>
<pre><code class="language-shell">cd dpymenus
</code></pre>
<pre><code class="language-shell">git checkout next
</code></pre>
</li>
<li>
<p>(Optional) Set up the example runner, so you can test your changes live. Create a <code>.env</code> file:</p>
<pre><code class="language-shell">echo &quot;BOT_TOKEN=your_private_token_here&quot; &gt; .env
</code></pre>
<p><em>Note: Replace the <code>your_private_token_here</code> text with the token from your
<strong><a href="https://discord.com/developers/applications">Discord Developers</a></strong>
bot page. If you are unsure what to use, please see the
<strong><a href="https://discordpy.readthedocs.io/en/stable/discord.html">discord.py guide</a></strong>.</em></p>
</li>
<li>
<p>Install the dependencies:</p>
<pre><code class="language-shell">poetry install
</code></pre>
</li>
<li>
<p>(Optional) Test that the runner is working with:</p>
<pre><code class="language-shell">poetry run examples
</code></pre>
<p>If the bot starts, and you can run commands in whatever server you have added the bot to, you are ready to go!</p>
</li>
</ol>
<h2 id="pull-requests"><a class="header" href="#pull-requests">Pull Requests</a></h2>
<ol>
<li>Fork the repository and create your branch from <code>next</code>.</li>
<li>Ensure any public API changes are reflected in the book, the relevant example, and docstrings.</li>
<li>Ensure you have tested your changes, and added any tests for functions which are not directly using <code>discord.py</code>.</li>
<li>Submit the PR! ‚ú®</li>
</ol>
<h2 id="coding-style"><a class="header" href="#coding-style">Coding Style</a></h2>
<p><code>dpymenus</code> uses a built-in <strong><a href="https://github.com/psf/black">black</a></strong> configuration to handle formatting. Your code will
automatically be formatted on submission via GitHub actions, but you can run <code>poetry run fmt</code> to manually format it.</p>
<ul>
<li>Follow PEP8 naming conventions.</li>
<li>Break up dense chunks of code where it makes sense (if/else try/catch, returns).</li>
<li>Ensure docstrings follow existing docstring structure.</li>
<li>All library code should be type annotated. Examples should not.
<ul>
<li>See the <code>dpymenus/types/__init__.py</code> file for existing built-in library types.</li>
</ul>
</li>
</ul>
<h2 id="license"><a class="header" href="#license">License</a></h2>
<p>By contributing, you agree that your contributions will be licensed under the MIT License.</p>
<div id="chapter_begin" style="break-before: page; page-break-before: always;"></div><h1 id="other-projects"><a class="header" href="#other-projects">Other Projects</a></h1>
<p>If you enjoy using <code>dpymenus</code>, you may like another library of mine called
<strong><a href="https://github.com/robertwayne/cogwatch">cogwatch</a></strong>. Cogwatch adds automatic hot-reloading to your command files, so you never have to call a custom reload function again <em>(mostly)</em>!</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        

                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                

                
            </nav>

        </div>

        

        

        

        
        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        

        

        
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        
        
        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
        
        

    </body>
</html>
